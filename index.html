<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AZRA-X | AI Assistant</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2563eb;
            --primary-dark: #1d4ed8;
            --bg-color: #f8fafc;
            --sidebar-bg: #ffffff;
            --chat-bg: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
            --user-msg-bg: #f1f5f9;
            --ai-msg-bg: #ffffff;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --radius: 12px;
        }

        .dark-mode {
            --primary-color: #3b82f6;
            --primary-dark: #2563eb;
            --bg-color: #0f172a;
            --sidebar-bg: #1e293b;
            --chat-bg: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: #334155;
            --user-msg-bg: #334155;
            --ai-msg-bg: #1e293b;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            transition: background-color 0.3s, color 0.3s;
            height: 100vh;
            overflow: hidden;
        }

        .app-container {
            display: flex;
            height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            z-index: 10;
        }

        .sidebar-header {
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary-color), #8b5cf6);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .logo-image {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            object-fit: cover;
        }

        .logo-text {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .new-chat-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s;
            width: 100%;
            justify-content: center;
            margin: 16px;
            width: calc(100% - 32px);
        }

        .new-chat-btn:hover {
            background-color: var(--primary-dark);
        }

        .history-section {
            flex: 1;
            padding: 0 16px;
            overflow-y: auto;
        }

        .history-title {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            font-weight: 600;
            padding: 0 8px;
        }

        .history-item {
            padding: 12px;
            border-radius: var(--radius);
            cursor: pointer;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background-color 0.2s;
            position: relative;
        }

        .history-item:hover {
            background-color: var(--user-msg-bg);
        }

        .history-item.active {
            background-color: var(--user-msg-bg);
            border-left: 3px solid var(--primary-color);
        }

        .history-icon {
            color: var(--text-secondary);
        }

        .history-text {
            font-size: 14px;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
        }

        .delete-history {
            opacity: 0;
            color: var(--text-secondary);
            transition: opacity 0.2s;
        }

        .history-item:hover .delete-history {
            opacity: 1;
        }

        .sidebar-footer {
            padding: 16px;
            border-top: 1px solid var(--border-color);
        }

        /* Main Chat Area */
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .chat-header {
            padding: 16px 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: var(--chat-bg);
        }

        .chat-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .icon-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }

        .icon-btn:hover {
            background-color: var(--user-msg-bg);
            color: var(--text-primary);
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .welcome-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            padding: 40px;
        }

        .welcome-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary-color), #8b5cf6);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 24px;
            color: white;
            font-size: 32px;
            font-weight: bold;
        }

        .welcome-image {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            object-fit: cover;
            margin-bottom: 24px;
        }

        .welcome-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .welcome-subtitle {
            font-size: 18px;
            color: var(--text-secondary);
            max-width: 600px;
            line-height: 1.6;
        }

        .message {
            display: flex;
            gap: 16px;
            max-width: 100%;
        }

        .user-msg {
            justify-content: flex-end;
        }

        .ai-msg {
            justify-content: flex-start;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-weight: bold;
        }

        .user-msg .message-avatar {
            background-color: var(--primary-color);
            color: white;
            order: 2;
        }

        .ai-msg .message-avatar {
            background-color: #10b981;
            color: white;
        }

        .message-content {
            flex: 1;
            max-width: 85%;
        }

        .user-msg .message-content {
            display: flex;
            justify-content: flex-end;
        }

        .message-text {
            line-height: 1.6;
            color: var(--text-primary);
            padding: 16px;
            border-radius: var(--radius);
        }

        .user-msg .message-text {
            background-color: var(--primary-color);
            color: white;
            border-top-right-radius: 4px;
        }

        .ai-msg .message-text {
            background-color: var(--ai-msg-bg);
            border: 1px solid var(--border-color);
            border-top-left-radius: 4px;
        }

        .code-block {
            background-color: #1e293b;
            color: #e2e8f0;
            border-radius: 8px;
            padding: 16px;
            margin: 12px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            border-left: 4px solid var(--primary-color);
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #334155;
        }

        .code-language {
            font-weight: 600;
            color: #94a3b8;
        }

        .code-actions {
            display: flex;
            gap: 8px;
        }

        .code-action-btn {
            background: none;
            border: none;
            color: #94a3b8;
            cursor: pointer;
            font-size: 14px;
            padding: 4px 8px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .code-action-btn:hover {
            background-color: #334155;
            color: #e2e8f0;
        }

        .chat-input-container {
            padding: 16px 24px;
            border-top: 1px solid var(--border-color);
            background-color: var(--chat-bg);
        }

        .chat-input-wrapper {
            display: flex;
            align-items: flex-end;
            gap: 12px;
            max-width: 800px;
            margin: 0 auto;
        }

        .chat-input {
            flex: 1;
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: 12px 16px;
            background-color: var(--chat-bg);
            color: var(--text-primary);
            resize: none;
            min-height: 56px;
            max-height: 200px;
            font-size: 16px;
            line-height: 1.5;
            transition: border-color 0.2s;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .send-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
            flex-shrink: 0;
        }

        .send-btn:hover {
            background-color: var(--primary-dark);
        }

        .send-btn:disabled {
            background-color: var(--text-secondary);
            cursor: not-allowed;
        }

        .input-actions {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
            justify-content: center;
        }

        .input-action-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 14px;
            transition: background-color 0.2s;
        }

        .input-action-btn:hover {
            background-color: var(--user-msg-bg);
            color: var(--text-primary);
        }

        /* Settings Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 100;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: var(--chat-bg);
            border-radius: var(--radius);
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 20px;
        }

        .modal-body {
            padding: 20px;
        }

        .profile-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 24px;
        }

        .profile-image {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 16px;
            border: 3px solid var(--primary-color);
        }

        .profile-name {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .profile-bio {
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: 16px;
        }

        .telegram-btn {
            background-color: #0088cc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s;
        }

        .telegram-btn:hover {
            background-color: #0077b5;
        }

        /* Mobile Styles */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 20px;
            cursor: pointer;
        }

        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 9;
        }

        /* Loading Animation */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 8px 0;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--text-secondary);
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) {
            animation-delay: -0.32s;
        }

        .typing-dot:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes typing {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Theme Toggle */
        .theme-toggle {
            position: relative;
            width: 60px;
            height: 30px;
        }

        .theme-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .theme-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #f1f5f9;
            transition: .4s;
            border-radius: 34px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 6px;
        }

        .theme-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
            z-index: 2;
        }

        .theme-icon {
            font-size: 14px;
            z-index: 1;
        }

        .sun-icon {
            color: #f59e0b;
        }

        .moon-icon {
            color: #64748b;
        }

        input:checked + .theme-slider {
            background-color: #1e293b;
        }

        input:checked + .theme-slider:before {
            transform: translateX(30px);
        }

        input:checked + .theme-slider .moon-icon {
            color: #e2e8f0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100%;
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .sidebar-overlay.active {
                display: block;
            }

            .mobile-menu-btn {
                display: block;
            }

            .chat-messages {
                padding: 16px;
            }

            .welcome-container {
                padding: 20px;
            }

            .welcome-title {
                font-size: 24px;
            }

            .welcome-subtitle {
                font-size: 16px;
            }

            .message-content {
                max-width: 90%;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <!-- Ganti src dengan path ke logo AZRA-X Anda -->
                    <img src="3.png" alt="AZRA-X" class="logo-image" id="logo-image">
                    <div class="logo-text">ùêÄùêôùêëùêÄ-ùêó</div>
                </div>
            </div>
            
            <button class="new-chat-btn" id="new-chat-btn">
                <i class="fas fa-plus"></i>
                Chat Baru
            </button>
            
            <div class="history-section">
                <div class="history-title">Riwayat Percakapan</div>
                <div class="history-list" id="history-list">
                    <!-- History items will be dynamically added here -->
                </div>
            </div>
        </div>
        
        <!-- Main Chat Area -->
        <div class="chat-container">
            <div class="chat-header">
                <button class="mobile-menu-btn">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="chat-title">ùêÄùêôùêëùêÄ-ùêó</div>
                <div class="header-actions">
                    <label class="theme-toggle">
                        <input type="checkbox" id="theme-toggle">
                        <span class="theme-slider">
                            <i class="fas fa-sun theme-icon sun-icon"></i>
                            <i class="fas fa-moon theme-icon moon-icon"></i>
                        </span>
                    </label>
                    <button class="icon-btn" id="settings-btn">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>
            
            <div class="chat-messages" id="chat-messages">
                <!-- Welcome screen -->
                <div class="welcome-container" id="welcome-screen">
                    <!-- Ganti src dengan path ke logo AZRA-X Anda -->
                    <img src="3.png" alt="AZRA-X" class="welcome-image" id="welcome-image">
                    <h1 class="welcome-title">Hai, saya AZRA-X</h1>
                    <p class="welcome-subtitle">Saya adalah asisten AI yang dibuat oleh Naufal Azra. Saya siap membantu Anda dengan berbagai pertanyaan, penulisan kode, analisis, dan banyak lagi.</p>
                </div>
                
                <!-- Messages will be dynamically added here -->
            </div>
            
            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <textarea class="chat-input" id="chat-input" placeholder="Ketik pesan Anda di sini..." rows="1"></textarea>
                    <button class="send-btn" id="send-btn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                <div class="input-actions">
                    <button class="input-action-btn">
                        <i class="fas fa-code"></i> Kode
                    </button>
                    <button class="input-action-btn">
                        <i class="fas fa-brain"></i> Analisis
                    </button>
                    <button class="input-action-btn">
                        <i class="fas fa-lightbulb"></i> Ide
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Settings Modal -->
        <div class="modal" id="settings-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">Pengaturan</h2>
                    <button class="close-modal" id="close-modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="profile-section">
                        <!-- Ganti src dengan path ke foto profil Telegram Anda -->
                        <img src="3.png" alt="Naufal Azra" class="profile-image" id="profile-image">
                        <h2 class="profile-name">Naufal Azra</h2>
                        <p class="profile-bio">Developer AZRA-X AI Assistant</p>
                        <button class="telegram-btn" id="telegram-btn">
                            <i class="fab fa-telegram"></i>
                            Telegram Saya
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Mobile Overlay -->
        <div class="sidebar-overlay" id="sidebar-overlay"></div>
    </div>

    <script>
        // API Configuration - GANTI DENGAN API KEY ANDA
        const API_KEY = "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";
        const API_URL = "https://platform.openai.com/";
        
        // System prompt untuk kalibrasi AI
        const SYSTEM_PROMPT = "Kamu adalah AI buatan Naufal Azra yang bernama AZRA-X. Kamu adalah asisten AI yang ramah, membantu, dan profesional. Berikan respons yang jelas, informatif, dan relevan. Untuk kode pemrograman, berikan contoh yang lengkap dan terstruktur dengan baik.";
        
        // DOM Elements
        const chatMessages = document.getElementById('chat-messages');
        const chatInput = document.getElementById('chat-input');
        const sendBtn = document.getElementById('send-btn');
        const welcomeScreen = document.getElementById('welcome-screen');
        const historyList = document.getElementById('history-list');
        const newChatBtn = document.getElementById('new-chat-btn');
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        const sidebar = document.querySelector('.sidebar');
        const sidebarOverlay = document.getElementById('sidebar-overlay');
        const themeToggle = document.getElementById('theme-toggle');
        const settingsBtn = document.getElementById('settings-btn');
        const settingsModal = document.getElementById('settings-modal');
        const closeModal = document.getElementById('close-modal');
        const telegramBtn = document.getElementById('telegram-btn');
        
        // Logo dan gambar - GANTI DENGAN PATH GAMBAR ANDA
        const logoImage = document.getElementById('logo-image');
        const welcomeImage = document.getElementById('welcome-image');
        const profileImage = document.getElementById('profile-image');
        
        // State
        let currentChatId = null;
        let chats = JSON.parse(localStorage.getItem('azra-x-chats')) || {};
        let currentMessages = [];
        let deleteTimer = null;
        
        // Initialize
        function init() {
            // Load chat history
            loadChatHistory();
            
            // Set up event listeners
            sendBtn.addEventListener('click', sendMessage);
            chatInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            chatInput.addEventListener('input', autoResize);
            
            newChatBtn.addEventListener('click', startNewChat);
            
            mobileMenuBtn.addEventListener('click', toggleSidebar);
            sidebarOverlay.addEventListener('click', toggleSidebar);
            
            themeToggle.addEventListener('change', toggleTheme);
            
            settingsBtn.addEventListener('click', openSettings);
            closeModal.addEventListener('click', closeSettings);
            telegramBtn.addEventListener('click', openTelegram);
            
            // Close modal when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === settingsModal) {
                    closeSettings();
                }
            });
            
            // Check for saved theme
            if (localStorage.getItem('azra-x-theme') === 'dark') {
                document.body.classList.add('dark-mode');
                themeToggle.checked = true;
            }
            
            // Auto-focus on input
            chatInput.focus();
        }
        
        // Auto-resize textarea
        function autoResize() {
            chatInput.style.height = 'auto';
            chatInput.style.height = (chatInput.scrollHeight) + 'px';
        }
        
        // Toggle sidebar on mobile
        function toggleSidebar() {
            sidebar.classList.toggle('active');
            sidebarOverlay.classList.toggle('active');
        }
        
        // Toggle theme
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('azra-x-theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
        }
        
        // Open settings modal
        function openSettings() {
            settingsModal.style.display = 'flex';
        }
        
        // Close settings modal
        function closeSettings() {
            settingsModal.style.display = 'none';
        }
        
        // Open Telegram
        function openTelegram() {
            window.open('https://t.me/naufalazraa', '_blank');
        }
        
        // Load chat history
        function loadChatHistory() {
            historyList.innerHTML = '';
            
            if (Object.keys(chats).length === 0) {
                historyList.innerHTML = '<div class="history-item"><span class="history-text">Tidak ada riwayat percakapan</span></div>';
                return;
            }
            
            Object.keys(chats).forEach(chatId => {
                const chat = chats[chatId];
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                if (chatId === currentChatId) {
                    historyItem.classList.add('active');
                }
                
                historyItem.innerHTML = `
                    <i class="fas fa-message history-icon"></i>
                    <span class="history-text">${chat.title}</span>
                    <i class="fas fa-trash delete-history" data-chat-id="${chatId}"></i>
                `;
                
                historyItem.addEventListener('click', (e) => {
                    if (!e.target.classList.contains('delete-history')) {
                        loadChat(chatId);
                    }
                });
                
                // Add long press to delete
                const deleteBtn = historyItem.querySelector('.delete-history');
                deleteBtn.addEventListener('mousedown', startDeleteTimer);
                deleteBtn.addEventListener('mouseup', cancelDeleteTimer);
                deleteBtn.addEventListener('mouseleave', cancelDeleteTimer);
                deleteBtn.addEventListener('touchstart', startDeleteTimer);
                deleteBtn.addEventListener('touchend', cancelDeleteTimer);
                deleteBtn.addEventListener('touchcancel', cancelDeleteTimer);
                
                historyList.appendChild(historyItem);
            });
        }
        
        // Start delete timer
        function startDeleteTimer(e) {
            e.preventDefault();
            const chatId = e.target.getAttribute('data-chat-id');
            
            deleteTimer = setTimeout(() => {
                deleteChat(chatId);
            }, 1500); // 1.5 seconds
        }
        
        // Cancel delete timer
        function cancelDeleteTimer() {
            if (deleteTimer) {
                clearTimeout(deleteTimer);
                deleteTimer = null;
            }
        }
        
        // Delete chat
        function deleteChat(chatId) {
            if (confirm('Hapus percakapan ini?')) {
                delete chats[chatId];
                
                if (currentChatId === chatId) {
                    currentChatId = null;
                    currentMessages = [];
                    renderMessages();
                    welcomeScreen.style.display = 'flex';
                }
                
                saveChats();
                loadChatHistory();
            }
        }
        
        // Start a new chat
        function startNewChat() {
            currentChatId = 'chat-' + Date.now();
            currentMessages = [];
            chats[currentChatId] = {
                title: 'Percakapan Baru',
                messages: []
            };
            
            saveChats();
            loadChatHistory();
            renderMessages();
            
            // Hide welcome screen
            welcomeScreen.style.display = 'none';
            
            // Auto-focus on input
            chatInput.focus();
            
            // Close sidebar on mobile
            if (window.innerWidth <= 768) {
                toggleSidebar();
            }
        }
        
        // Load a specific chat
        function loadChat(chatId) {
            currentChatId = chatId;
            currentMessages = chats[chatId].messages;
            
            loadChatHistory();
            renderMessages();
            
            // Hide welcome screen
            welcomeScreen.style.display = 'none';
            
            // Close sidebar on mobile
            if (window.innerWidth <= 768) {
                toggleSidebar();
            }
        }
        
        // Save chats to localStorage
        function saveChats() {
            localStorage.setItem('azra-x-chats', JSON.stringify(chats));
        }
        
        // Render messages
        function renderMessages() {
            chatMessages.innerHTML = '';
            
            if (currentMessages.length === 0) {
                return;
            }
            
            currentMessages.forEach(message => {
                addMessageToChat(message.role, message.content, false);
            });
            
            // Scroll to bottom
            scrollToBottom();
        }
        
        // Add message to chat
        function addMessageToChat(role, content, isNew = true) {
            if (isNew) {
                currentMessages.push({ role, content });
                
                // Update chat title if it's the first user message
                if (role === 'user' && currentMessages.length === 1) {
                    const title = content.length > 30 ? content.substring(0, 30) + '...' : content;
                    chats[currentChatId].title = title;
                    saveChats();
                    loadChatHistory();
                }
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role === 'user' ? 'user-msg' : 'ai-msg'}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            const textDiv = document.createElement('div');
            textDiv.className = 'message-text';
            
            // Process content for code blocks
            const processedContent = processContent(content);
            textDiv.innerHTML = processedContent;
            
            contentDiv.appendChild(textDiv);
            messageDiv.appendChild(contentDiv);
            
            chatMessages.appendChild(messageDiv);
            
            // Add copy functionality to code blocks
            addCopyFunctionality();
            
            if (isNew) {
                saveChats();
                scrollToBottom();
            }
        }
        
        // Process content to format code blocks
        function processContent(content) {
            // Simple code block detection and formatting
            let processed = content.replace(/\n/g, '<br>');
            
            // Detect code blocks (simple regex for demonstration)
            const codeBlockRegex = /```(\w+)?\s*([\s\S]*?)```/g;
            processed = processed.replace(codeBlockRegex, (match, language, code) => {
                const lang = language || 'text';
                return `
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-language">${lang.toUpperCase()}</span>
                            <div class="code-actions">
                                <button class="code-action-btn copy-btn">
                                    <i class="fas fa-copy"></i> Salin
                                </button>
                            </div>
                        </div>
                        <pre><code>${code.trim()}</code></pre>
                    </div>
                `;
            });
            
            return processed;
        }
        
        // Add copy functionality to code blocks
        function addCopyFunctionality() {
            document.querySelectorAll('.copy-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const codeBlock = this.closest('.code-block');
                    const code = codeBlock.querySelector('code').textContent;
                    
                    navigator.clipboard.writeText(code).then(() => {
                        const originalText = this.innerHTML;
                        this.innerHTML = '<i class="fas fa-check"></i> Disalin';
                        
                        setTimeout(() => {
                            this.innerHTML = originalText;
                        }, 2000);
                    });
                });
            });
        }
        
        // Scroll to bottom of chat
        function scrollToBottom() {
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // Send message to AI
        async function sendMessage() {
            const message = chatInput.value.trim();
            
            if (!message) return;
            
            // If no active chat, start a new one
            if (!currentChatId) {
                startNewChat();
            }
            
            // Add user message to chat
            addMessageToChat('user', message);
            
            // Clear input
            chatInput.value = '';
            autoResize();
            
            // Disable send button
            sendBtn.disabled = true;
            
            // Show typing indicator
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'message ai-msg';
            typingIndicator.innerHTML = `
                <div class="message-content">
                    <div class="message-text">
                        <div class="typing-indicator">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                </div>
            `;
            chatMessages.appendChild(typingIndicator);
            scrollToBottom();
            
            try {
                // Prepare messages for API
                const apiMessages = [
                    { role: 'system', content: SYSTEM_PROMPT },
                    ...currentMessages.map(msg => ({ role: msg.role, content: msg.content }))
                ];
                
                // Call AI API
                const response = await callAIAPI(apiMessages);
                
                // Remove typing indicator
                chatMessages.removeChild(typingIndicator);
                
                // Add AI response to chat
                addMessageToChat('assistant', response);
            } catch (error) {
                // Remove typing indicator
                chatMessages.removeChild(typingIndicator);
                
                // Show error message
                addMessageToChat('assistant', 'Maaf, terjadi kesalahan saat memproses permintaan Anda. Silakan coba lagi.');
                console.error('Error:', error);
            }
            
            // Re-enable send button
            sendBtn.disabled = false;
            chatInput.focus();
        }
        
        // Call AI API
        async function callAIAPI(messages) {
            // In a real implementation, you would call your AI API here
            // This is a mock implementation for demonstration purposes
            
            // Simulate API delay
            await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 2000));
            
            // Mock responses based on user message
            const userMessage = messages[messages.length - 1].content.toLowerCase();
            
            if (userMessage.includes('hallo') || userMessage.includes('hai') || userMessage.includes('halo')) {
                return "Halo! Saya AZRA-X, asisten AI yang dibuat oleh Naufal Azra. Ada yang bisa saya bantu?";
            } else if (userMessage.includes('buatkan kode') || userMessage.includes('program') || userMessage.includes('coding')) {
                return `Tentu, saya akan membantu Anda dengan kode pemrograman. Berikut adalah contoh kode JavaScript untuk menyapa pengguna:

\`\`\`javascript
// Fungsi untuk menyapa pengguna
function sapaPengguna(nama) {
    return \`Halo, \${nama}! Selamat datang di AZRA-X.\`;
}

// Contoh penggunaan
const namaPengguna = "Naufal";
const salam = sapaPengguna(namaPengguna);
console.log(salam);
// Output: Halo, Naufal! Selamat datang di AZRA-X.
\`\`\`

Apakah Anda memerlukan contoh kode dalam bahasa pemrograman lain atau untuk kasus penggunaan tertentu?`;
            } else if (userMessage.includes('terima kasih')) {
                return "Sama-sama! Senang bisa membantu Anda. Jika ada pertanyaan lain, jangan ragu untuk bertanya.";
            } else {
                return "Saya memahami pertanyaan Anda. Sebagai AI yang dikembangkan oleh Naufal Azra, saya siap membantu dengan berbagai topik termasuk pemrograman, analisis data, penulisan konten, dan banyak lagi. Bisakah Anda memberikan lebih banyak detail tentang apa yang Anda butuhkan?";
            }
            
            // In a real implementation, you would use something like:
            /*
            const response = await fetch(API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${API_KEY}`
                },
                body: JSON.stringify({
                    model: 'gpt-3.5-turbo',
                    messages: messages,
                    temperature: 0.7,
                    max_tokens: 1000
                })
            });
            
            if (!response.ok) {
                throw new Error('API request failed');
            }
            
            const data = await response.json();
            return data.choices[0].message.content;
            */
        }
        
        // Initialize the app
        init();
    </script>
</body>
</html>
